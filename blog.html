<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Blog - Nawigator Wewnętrznych Światów i Cyfrowych Rozwiązań</title>
    <style>
        /* CSS - SKOPIUJ WSZYSTKIE STYLE Z SEKCJI <style> TWOJEGO PLIKU index.html */
        /* ... (tutaj wklej CAŁĄ zawartość tagu <style> z index.html) ... */
        /* DODATKOWE/ZMODYFIKOWANE STYLE SPECYFICZNE DLA blog.html (jeśli są, np. dla .blog-page-header) */
        /* Poniżej są style, które już miałeś w blog.html, zostawiam je i dodaję/modyfikuję to, co potrzebne dla menu i języków */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --navy-blue: #1e3a5f;
            --dark-navy: #14293d;
            --warm-ochre: #d4812a;
            --rust-orange: #b8651f;
            --sage-green: #8aa387;
            --light-beige: #f5f3f0;
            --medium-gray: #7d8285;
            --light-gray: #e8e6e3;
        }

        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            line-height: 1.6;
            color: var(--dark-navy);
            background-color: var(--light-beige);
            scroll-behavior: smooth;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Language Selector - SKOPIOWANE Z INDEX.HTML */
        .language-selector {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .lang-btn {
            background: none;
            border: none;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            color: white;
            font-size: 0.9rem;
        }

        .lang-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .lang-btn.active {
            background: rgba(255, 255, 255, 0.2);
        }

        .flag {
            width: 24px;
            height: 18px;
            display: inline-block;
            border-radius: 2px;
            position: relative;   
            overflow: hidden;     
        }

        .flag-pl {
            background: linear-gradient(to bottom, white 0%, white 50%, #dc143c 50%, #dc143c 100%);
        }
        .flag-pl::before, .flag-pl::after { content: none; }


        .flag-en {
            background-color: white;
        }
         .flag-en::before { content: none; }
        .flag-en::after {
            content: "";
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background-image:
                linear-gradient(#C8102E, #C8102E), 
                linear-gradient(#C8102E, #C8102E); 
            background-repeat: no-repeat;
            background-position: center center;
            background-size:
                100% 22.22%, 
                16.66% 100%; 
        }

        /* Header - SKOPIOWANE I ZMODYFIKOWANE Z INDEX.HTML */
        header {
            background: linear-gradient(135deg, var(--navy-blue) 0%, var(--dark-navy) 100%);
            color: white;
            padding: 1rem 0;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo { /* Ogólne style dla logo */
            display: flex;
            align-items: center;
        }
        /* Kontener dla linku logo, aby zachować gap i wyrównanie jak w index.html */
        .logo a.logo-link-wrapper {
            display: flex;
            align-items: center;
            gap: 15px; /* Ten sam odstęp co w .logo w index.html */
            text-decoration: none;
            color: inherit; /* Aby tekst h1 był biały */
        }

        .logo a.logo-link-wrapper img { /* Style dla obrazka logo w linku */
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: var(--light-beige);
            padding: 5px;
        }

        .logo a.logo-link-wrapper h1 { /* Style dla tekstu logo w linku */
            font-size: 1.5rem;
            font-weight: 600;
            margin: 0; /* Usuń domyślne marginesy h1 */
        }
        
        .nav-right {
            display: flex;
            align-items: center;
            gap: 30px;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-links a {
            color: white;
            text-decoration: none;
            transition: color 0.3s ease;
            font-weight: 500;
        }

        .nav-links a:hover,
        .nav-links a.active { /* .active dla podświetlenia bieżącej strony */
            color: var(--warm-ochre);
        }

        /* Mobile Menu Toggle - SKOPIOWANE Z INDEX.HTML */
        .mobile-menu-toggle {
            display: none; 
            background: none;
            border: none;
            color: white;
            font-size: 1.8rem; 
            cursor: pointer;
            padding: 5px;
        }

        /* Pozostałe style specyficzne dla blog.html (Blog Header, Categories, Posts Grid, Newsletter, Footer, Loading, Responsive, lang-content, Animations) */
        /* ... (wklej tutaj odpowiednie style z Twojego blog.html, które już miałeś, upewniając się, że nie kolidują z nowymi stylami dla menu) ... */
        /* Poniżej są style, które już miałeś w blog.html, dostosowane lub uzupełnione */
        .blog-page-header { 
            background: linear-gradient(135deg, var(--navy-blue) 0%, var(--dark-navy) 50%, var(--sage-green) 100%);
            color: white;
            padding: 140px 0 80px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }
        .blog-page-header::before {
            content: '';
            position: absolute;
            top: 0; left: 0; right: 0; bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="50" cy="50" r="2" fill="rgba(255,255,255,0.1)"/></svg>') repeat;
            opacity: 0.3;
        }
        .blog-page-header h1 {
            font-size: 3rem; margin-bottom: 20px; font-weight: 300; line-height: 1.2; position: relative; z-index: 2;
        }
        .blog-page-header p {
            font-size: 1.2rem; opacity: 0.9; position: relative; z-index: 2; max-width: 700px; margin: 0 auto;
        }
        .categories-section { 
            background: white; padding: 40px 0; box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .category-list {
            display: flex; justify-content: center; gap: 20px; flex-wrap: wrap;
        }
        .category-btn {
            background: var(--light-gray); color: var(--navy-blue); border: none; padding: 10px 25px; border-radius: 25px; cursor: pointer; font-size: 0.9rem; font-weight: 500; transition: all 0.3s ease;
        }
        .category-btn:hover { background: var(--navy-blue); color: white; }
        .category-btn.active { background: var(--warm-ochre); color: white; }
        .blog-posts-section { padding: 80px 0; background: var(--light-beige); }
        .posts-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(350px, 1fr)); gap: 40px; }
        .blog-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 5px 20px rgba(0,0,0,0.1); transition: transform 0.3s ease, box-shadow 0.3s ease; display: flex; flex-direction: column; }
        .blog-card:hover { transform: translateY(-5px); box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        .blog-card-image { width: 100%; height: 200px; background-size: cover; background-position: center; position: relative; overflow: hidden; background-image: linear-gradient(135deg, var(--sage-green), var(--navy-blue)); }
        .blog-card-image .category-tag { position: absolute; top: 20px; left: 20px; background: var(--warm-ochre); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: 500; }
        .blog-card-content { padding: 30px; flex-grow: 1; display: flex; flex-direction: column; }
        .blog-card-meta { display: flex; gap: 20px; margin-bottom: 15px; font-size: 0.9rem; color: var(--medium-gray); }
        .blog-card h3 { color: var(--navy-blue); font-size: 1.4rem; margin-bottom: 15px; line-height: 1.3; }
        .blog-card p.excerpt { color: var(--medium-gray); line-height: 1.6; margin-bottom: 20px; flex-grow: 1; }
        .read-more { color: var(--warm-ochre); text-decoration: none; font-weight: 500; display: inline-flex; align-items: center; gap: 5px; transition: gap 0.3s ease; margin-top: auto; }
        .read-more:hover { gap: 10px; }
        .featured-post-container { margin-bottom: 60px; }
        .featured-post { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.1); display: grid; grid-template-columns: 1fr 1fr; min-height: 400px; }
        .featured-image { background-size: cover; background-position: center; position: relative; background-image: linear-gradient(135deg, var(--navy-blue), var(--sage-green)); }
        .featured-content { padding: 60px; display: flex; flex-direction: column; justify-content: center; }
        .featured-tag { background: var(--warm-ochre); color: white; padding: 5px 15px; border-radius: 20px; font-size: 0.8rem; font-weight: 500; display: inline-block; margin-bottom: 20px; align-self: flex-start; }
        .featured-content h2 { color: var(--navy-blue); font-size: 2rem; margin-bottom: 20px; line-height: 1.3; }
        .featured-content p.excerpt { color: var(--medium-gray); line-height: 1.6; margin-bottom: 30px; font-size: 1.1rem; }
        .newsletter { background: var(--navy-blue); color: white; padding: 60px 0; text-align: center; }
        .newsletter h2 { font-size: 2rem; margin-bottom: 20px; }
        .newsletter p { margin-bottom: 30px; opacity: 0.9; }
        .newsletter-form { display: flex; max-width: 500px; margin: 0 auto; gap: 10px; }
        .newsletter-form input { flex: 1; padding: 15px 20px; border: none; border-radius: 5px; font-size: 1rem; background: rgba(255,255,255,0.1); color: white; border: 2px solid transparent; }
        .newsletter-form input::placeholder { color: rgba(255,255,255,0.7); }
        .newsletter-form input:focus { outline: none; border-color: var(--warm-ochre); background: rgba(255,255,255,0.15); }
        .newsletter-form button { background: var(--warm-ochre); color: white; border: none; padding: 15px 30px; border-radius: 5px; font-size: 1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .newsletter-form button:hover { background: var(--rust-orange); }
        footer { background: var(--dark-navy); color: white; text-align: center; padding: 30px 0; }
        .loading { text-align: center; padding: 60px; color: var(--medium-gray); font-size: 1.1em; }
        
        /* Responsive - DODAJ STYLE DLA MOBILNEGO MENU Z INDEX.HTML */
        @media (max-width: 768px) {
            .nav-links { display: none; }
            .mobile-menu-toggle { display: block; } /* Pokaż hamburger */
            .nav-links.active-mobile {
                display: flex;
                flex-direction: column;
                position: absolute;
                top: 68px; /* Dopasuj do wysokości headera */
                left: 0;
                width: 100%;
                background: var(--dark-navy); 
                padding: 20px;
                box-shadow: 0 5px 10px rgba(0,0,0,0.2);
                gap: 0; 
            }
            .nav-links.active-mobile li { margin-bottom: 15px; width: 100%; text-align: center; }
            .nav-links.active-mobile a { font-size: 1.1rem; display: block; padding: 10px 0; }

            /* Reszta twoich styli responsywnych dla blog.html */
            .blog-page-header h1 { font-size: 2.2rem; }
            .blog-page-header p { font-size: 1.1rem; }
            .posts-grid { grid-template-columns: 1fr; }
            .featured-post { grid-template-columns: 1fr; }
            .featured-image { min-height: 250px; }
            .featured-content { padding: 40px; }
            .featured-content h2 { font-size: 1.5rem; }
            .newsletter-form { flex-direction: column; }
            .category-list { padding: 0 20px; }
        }

        /* Language-specific content - SKOPIOWANE Z INDEX.HTML */
        .lang-content { display: none; }
        .lang-content.active { display: block; }

        /* Animations - ZMODYFIKOWANE z index.html, aby działały po zmianie języka/kategorii */
         .fade-in {
            opacity: 0;
            transform: translateY(30px);
            transition: opacity 0.8s ease-out, transform 0.8s ease-out;
        }
        
        .fade-in.visible { /* Klasa dodawana przez JS */
            opacity: 1;
            transform: translateY(0);
        }

    </style>
</head>
<body>
    <header>
        <nav class="container">
            <div class="logo">
                <!-- Link do strony głównej -->
                <a href="index.html" class="logo-link-wrapper">
                    <img src="images/logo.png" alt="Logo Adama">
                    <!-- Tytuł w logo będzie dynamicznie ustawiany przez JS -->
                    <h1 class="lang-content active" data-lang="pl">Adam</h1>
                    <h1 class="lang-content" data-lang="en">Adam</h1>
                </a>
            </div>
            <div class="nav-right">
                <ul class="nav-links" id="nav-links-blog">
                    <!-- Linki nawigacyjne będą dynamicznie wstawiane przez JS -->
                </ul>
                <div class="language-selector">
                    <button class="lang-btn active" data-lang="pl">
                        <span class="flag flag-pl"></span><span>PL</span>
                    </button>
                    <button class="lang-btn" data-lang="en">
                        <span class="flag flag-en"></span><span>EN</span>
                    </button>
                </div>
                <button class="mobile-menu-toggle" id="mobile-menu-toggle-blog" aria-label="Toggle menu">☰</button>
            </div>
        </nav>
    </header>

    <section class="blog-page-header">
        <div class="container">
            <h1 class="lang-content active" data-lang="pl">Blog</h1>
            <h1 class="lang-content" data-lang="en">Blog</h1>
            <p class="lang-content active" data-lang="pl">Przemyślenia o technologii, rozwoju i ludzkiej naturze</p>
            <p class="lang-content" data-lang="en">Thoughts on technology, development and human nature</p>
        </div>
    </section>

    <section class="categories-section">
        <div class="container">
            <div class="category-list" id="category-list">
                <!-- Kategorie będą dynamicznie wstawiane przez JS -->
            </div>
        </div>
    </section>

    <section class="blog-posts-section">
        <div class="container">
            <div class="featured-post-container" id="featured-post-container">
                 <div class="loading lang-content active" data-lang="pl">Ładowanie wyróżnionego postu...</div>
                 <div class="loading lang-content" data-lang="en">Loading featured post...</div>
            </div>
            <div class="posts-grid" id="posts-grid">
                <div class="loading lang-content active" data-lang="pl">Ładowanie postów...</div>
                <div class="loading lang-content" data-lang="en">Loading posts...</div>
            </div>
        </div>
    </section>

    <section class="newsletter">
        <div class="container">
            <h2 class="lang-content active" data-lang="pl">Bądź na bieżąco</h2>
            <h2 class="lang-content" data-lang="en">Stay Updated</h2>
            <p class="lang-content active" data-lang="pl">Otrzymuj powiadomienia o nowych artykułach i przemyśleniach</p>
            <p class="lang-content" data-lang="en">Get notifications about new articles and insights</p>
            <form class="newsletter-form" data-netlify="true" name="newsletter-blog"> <!-- Inna nazwa formularza dla Netlify -->
                <input type="hidden" name="form-name" value="newsletter-blog" />
                <input type="email" name="email" id="newsletter-email-blog" required>
                <button type="submit" id="newsletter-submit-blog">Zapisz się</button>
            </form>
        </div>
    </section>

    <footer>
        <div class="container">
            <p class="lang-content active" data-lang="pl">© 2025 Adam - Nawigator Wewnętrznych Światów i Cyfrowych Rozwiązań. Wszystkie prawa zastrzeżone.</p>
            <p class="lang-content" data-lang="en">© 2025 Adam - Navigator of Inner Worlds and Digital Solutions. All rights reserved.</p>
        </div>
    </footer>

    <script>
        // SKOPIUJ CAŁY KOD JAVASCRIPT Z PLIKU index.html (ten dotyczący `content`, języków, menu mobilnego, animacji)
        // ... (tutaj wklej CAŁY skrypt z index.html, który dostarczyłeś wcześniej) ...
        // PONIŻEJ ZNAJDUJE SIĘ PRZYKŁAD, JAK POWINIEN WYGLĄDAĆ TEN SKRYPT DLA blog.html
        // ZAŁOŻENIE: struktura `content` i funkcje pomocnicze są takie same
        // Musisz dostosować ID elementów, jeśli są inne (np. nav-links-blog)

        const content = { // Ta sama struktura content co w index.html
            pl: {
                nav: [ /* Zaktualizuj linki, aby poprawnie wskazywały z blog.html do index.html#sekcja */
                    { text: 'Start', href: 'index.html#home' },
                    { text: 'O mnie', href: 'index.html#about' },
                    { text: 'Portfolio', href: 'index.html#portfolio' },
                    { text: 'Blog', href: 'blog.html' }, 
                    { text: 'Usługi', href: 'index.html#services' },
                    { text: 'Kontakt', href: 'index.html#contact' }
                ],
                categories: [ // Kategorie specyficzne dla bloga
                    { id: 'all', text: 'Wszystkie' },
                    { id: 'ai', text: 'Sztuczna Inteligencja' },
                    { id: 'psychology', text: 'Psychologia' },
                    { id: 'technology', text: 'Technologia' },
                    { id: 'personal', text: 'Rozwój osobisty' }
                ],
                blogPage: {
                    loadingFeatured: "Ładowanie wyróżnionego postu...",
                    loadingPosts: "Ładowanie postów...",
                    noPostsInCategory: "Brak postów w tej kategorii.",
                    readMore: "Czytaj więcej →",
                    errorLoading: "Błąd ładowania postów:"
                },
                newsletter: {
                    emailPlaceholder: "Twój e-mail",
                    submitButton: "Zapisz się"
                }
                // ... (inne teksty dla blog.html jeśli potrzebne)
            },
            en: {
                nav: [
                    { text: 'Home', href: 'index.html#home' },
                    { text: 'About', href: 'index.html#about' },
                    { text: 'Portfolio', href: 'index.html#portfolio' },
                    { text: 'Blog', href: 'blog.html' },
                    { text: 'Services', href: 'index.html#services' },
                    { text: 'Contact', href: 'index.html#contact' }
                ],
                categories: [
                    { id: 'all', text: 'All' },
                    { id: 'ai', text: 'Artificial Intelligence' },
                    { id: 'psychology', text: 'Psychology' },
                    { id: 'technology', text: 'Technology' },
                    { id: 'personal', text: 'Personal Development' }
                ],
                blogPage: {
                    loadingFeatured: "Loading featured post...",
                    loadingPosts: "Loading posts...",
                    noPostsInCategory: "No posts in this category.",
                    readMore: "Read more →",
                    errorLoading: "Error loading posts:"
                },
                 newsletter: {
                    emailPlaceholder: "Your e-mail",
                    submitButton: "Subscribe"
                }
                // ... (inne teksty dla blog.html jeśli potrzebne)
            }
        };

        let currentLanguage = 'pl';
        let currentCategory = 'all';
        let allPosts = [];

        function formatDate(dateString) {
            if (!dateString) return '';
            const cleanDate = dateString.split('T')[0];
            if (cleanDate.match(/^\d{4}-\d{2}-\d{2}$/)) {
                const [year, month, day] = cleanDate.split('-');
                return `${day}.${month}.${year}`;
            }
            try {
                const date = new Date(dateString);
                if (!isNaN(date.getTime())) {
                    return date.toLocaleDateString(currentLanguage === 'pl' ? 'pl-PL' : 'en-US', {
                        year: 'numeric', month: '2-digit', day: '2-digit'
                    });
                }
            } catch (e) { console.error('Błąd formatowania daty:', e); }
            return cleanDate;
        }
        
        // --- FUNKCJE Z TWOJEGO `blog.html` do ładowania i parsowania postów ---
        async function loadBlogPosts() {
            const loadingPostsEl = document.querySelector('#posts-grid .loading');
            const loadingFeaturedEl = document.querySelector('#featured-post-container .loading');
            
            if (loadingPostsEl) loadingPostsEl.textContent = content[currentLanguage].blogPage.loadingPosts;
            if (loadingFeaturedEl) loadingFeaturedEl.textContent = content[currentLanguage].blogPage.loadingFeatured;

            try {
                const response = await fetch('https://api.github.com/repos/adamsosx/portfolio/contents/_posts');
                if (!response.ok) { throw new Error(`HTTP error! status: ${response.status}`); }
                const files = await response.json();
                const postsPromises = files.filter(file => file.name.endsWith('.md') && file.type === 'file')
                    .map(async (file) => {
                        try {
                            const fileResponse = await fetch(file.download_url);
                            const fileContent = await fileResponse.text();
                            const post = parseMarkdownPost(fileContent, file.name);
                            return (post && post.published !== 'false') ? post : null;
                        } catch (fileError) {
                            console.error('Błąd ładowania pliku:', file.name, fileError);
                            return null;
                        }
                    });
                
                const loadedPosts = (await Promise.all(postsPromises)).filter(post => post !== null);
                allPosts = loadedPosts.sort((a, b) => new Date(b.date) - new Date(a.date));
                displayPosts();
            } catch (error) {
                console.error('Błąd ładowania postów:', error);
                const errorText = content[currentLanguage].blogPage.errorLoading;
                if (document.getElementById('posts-grid')) document.getElementById('posts-grid').innerHTML = `<p class="error">${errorText} ${error.message}</p>`;
                if (document.getElementById('featured-post-container')) document.getElementById('featured-post-container').innerHTML = '';
            }
        }

        function parseMarkdownPost(markdownContent, filename) {
            const frontMatterMatch = markdownContent.match(/^---\r?\n([\s\S]*?)\r?\n---\r?\n([\s\S]*)$/);
            if (!frontMatterMatch) { return null; }
            const frontMatter = frontMatterMatch[1];
            const body = frontMatterMatch[2];
            const post = { body };
            frontMatter.split(/\r?\n/).forEach(line => {
                const colonIndex = line.indexOf(':');
                if (colonIndex > 0) {
                    const key = line.substring(0, colonIndex).trim();
                    let value = line.substring(colonIndex + 1).trim();
                    if ((value.startsWith('"') && value.endsWith('"')) || (value.startsWith("'") && value.endsWith("'"))) {
                        value = value.slice(1, -1);
                    }
                    post[key] = value;
                }
            });
            post.slug = filename.replace('.md', '');
            if (!post.categoryId && post.category) {
                const categoryLower = post.category.toLowerCase();
                if (categoryLower.includes('sztuczna') || categoryLower.includes('artificial') || categoryLower.includes('ai')) post.categoryId = 'ai';
                else if (categoryLower.includes('psycholog')) post.categoryId = 'psychology';
                else if (categoryLower.includes('technolog')) post.categoryId = 'technology';
                else if (categoryLower.includes('rozwój') || categoryLower.includes('personal')) post.categoryId = 'personal';
                else post.categoryId = 'technology';
            }
            if (!post.categoryId) post.categoryId = 'technology';
            return post;
        }

        function displayPosts() {
            const postsGrid = document.getElementById('posts-grid');
            const featuredContainer = document.getElementById('featured-post-container');
            
            let filteredPosts = allPosts;
            if (currentCategory !== 'all') {
                filteredPosts = allPosts.filter(post => post.categoryId === currentCategory);
            }
            
            const readMoreText = content[currentLanguage].blogPage.readMore;

            if (filteredPosts.length > 0) {
                const featured = filteredPosts[0];
                featuredContainer.innerHTML = `
                    <div class="featured-post fade-in">
                        <div class="featured-image" style="background-image: url('${featured.image || 'images/default-featured.jpg'}');"></div>
                        <div class="featured-content">
                            <span class="featured-tag">${featured.category || 'Blog'}</span>
                            <h2>${featured.title || 'Bez tytułu'}</h2>
                            <p class="excerpt">${featured.excerpt || featured.body.substring(0, 150) + '...'}</p>
                            <div class="blog-card-meta">
                                <span>${formatDate(featured.date)}</span>
                                <span>${featured.readTime || (currentLanguage === 'pl' ? '5 min czytania' : '5 min read')}</span>
                            </div>
                            <a href="post.html?slug=${featured.slug}" class="read-more">${readMoreText}</a>
                        </div>
                    </div>
                `;
                
                const remainingPosts = filteredPosts.slice(1);
                postsGrid.innerHTML = remainingPosts.map(post => `
                    <div class="blog-card fade-in">
                        <div class="blog-card-image" style="background-image: url('${post.image || 'images/default-card.jpg'}');">
                            <span class="category-tag">${post.category || 'Blog'}</span>
                        </div>
                        <div class="blog-card-content">
                            <div class="blog-card-meta">
                                <span>${formatDate(post.date)}</span>
                                <span>${post.readTime || (currentLanguage === 'pl' ? '5 min czytania' : '5 min read')}</span>
                            </div>
                            <h3>${post.title || 'Bez tytułu'}</h3>
                            <p class="excerpt">${post.excerpt || post.body.substring(0, 120) + '...'}</p>
                            <a href="post.html?slug=${post.slug}" class="read-more">${readMoreText}</a>
                        </div>
                    </div>
                `).join('');
            } else {
                featuredContainer.innerHTML = '';
                postsGrid.innerHTML = `<p>${content[currentLanguage].blogPage.noPostsInCategory}</p>`;
            }
            applyFadeInAnimation();
        }

        function filterByCategory(categoryId) {
            currentCategory = categoryId;
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            const activeBtn = document.querySelector(`.category-btn[data-category="${categoryId}"]`);
            if(activeBtn) activeBtn.classList.add('active');
            displayPosts();
        }
        // --- KONIEC FUNKCJI Z TWOJEGO `blog.html` ---


        // --- FUNKCJE Z `index.html` DO OBSŁUGI JĘZYKA I MENU MOBILNEGO ---
        function updateNavigation() {
            const navLinksContainer = document.getElementById('nav-links-blog'); // Użyj nowego ID dla bloga
            if (!navLinksContainer) return;
            navLinksContainer.innerHTML = ''; 
            content[currentLanguage].nav.forEach(item => {
                const li = document.createElement('li');
                const a = document.createElement('a');
                a.href = item.href;
                a.textContent = item.text;
                if (item.href.includes('blog.html') && window.location.pathname.includes('blog.html')) {
                    a.classList.add('active'); // Podświetl link do bloga na stronie bloga
                }
                li.appendChild(a);
                navLinksContainer.appendChild(li);
            });
        }
        
        function updateCategoryButtons() {
            const categoryList = document.getElementById('category-list');
            if (!categoryList) return;
            categoryList.innerHTML = content[currentLanguage].categories.map(cat => 
                `<button class="category-btn ${cat.id === currentCategory ? 'active' : ''}" 
                         data-category="${cat.id}">${cat.text}</button>`
            ).join('');
        }

        function updateNewsletterPlaceholders() {
            const emailInput = document.getElementById('newsletter-email-blog');
            const submitBtn = document.getElementById('newsletter-submit-blog');
            if(emailInput) emailInput.placeholder = content[currentLanguage].newsletter.emailPlaceholder;
            if(submitBtn) submitBtn.textContent = content[currentLanguage].newsletter.submitButton;
        }


        function changeLanguage(lang) {
            currentLanguage = lang;
            document.documentElement.lang = lang; 
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.classList.toggle('active', btn.getAttribute('data-lang') === lang);
            });
            
            document.querySelectorAll('.lang-content').forEach(element => {
                element.classList.toggle('active', element.getAttribute('data-lang') === lang);
            });
            
            updateNavigation();
            updateCategoryButtons(); // Aktualizuj przyciski kategorii
            updateNewsletterPlaceholders(); // Aktualizuj placeholder i przycisk newslettera
            displayPosts(); // Przeładuj posty, aby zaktualizować np. "Czytaj więcej"
            
            if (lang === 'en') {
                document.title = 'Blog - Navigator of Inner Worlds and Digital Solutions';
            } else {
                document.title = 'Blog - Nawigator Wewnętrznych Światów i Cyfrowych Rozwiązań';
            }
        }
        
        let intersectionObserverInstanceBlog;
        function applyFadeInAnimation() {
            if (intersectionObserverInstanceBlog) {
                intersectionObserverInstanceBlog.disconnect();
            }
            const observerOptions = { threshold: 0.1, rootMargin: '0px 0px -50px 0px' };
            intersectionObserverInstanceBlog = new IntersectionObserver(function(entries, observer) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, observerOptions);

            document.querySelectorAll('.fade-in').forEach(el => {
                // Reset initial styles for re-triggering if needed, or ensure they are set
                el.style.opacity = '0'; 
                el.style.transform = 'translateY(30px)';
                intersectionObserverInstanceBlog.observe(el);
            });
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            currentLanguage = document.documentElement.lang || 'pl';
            if (currentLanguage !== 'pl' && currentLanguage !== 'en') {
                currentLanguage = 'pl';
                document.documentElement.lang = 'pl';
            }

            loadBlogPosts(); // Ładuje posty i potem wywołuje displayPosts()
            updateNavigation();
            updateCategoryButtons();
            updateNewsletterPlaceholders();
            
            document.querySelectorAll('.lang-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    changeLanguage(this.getAttribute('data-lang'));
                });
            });
            
            const categoryList = document.getElementById('category-list');
            if(categoryList) {
                categoryList.addEventListener('click', function(e) {
                    if (e.target.classList.contains('category-btn')) {
                        filterByCategory(e.target.getAttribute('data-category'));
                    }
                });
            }

            const mobileMenuToggle = document.getElementById('mobile-menu-toggle-blog');
            const navLinksContainer = document.getElementById('nav-links-blog');

            if (mobileMenuToggle && navLinksContainer) {
                mobileMenuToggle.addEventListener('click', function() {
                    navLinksContainer.classList.toggle('active-mobile');
                });
            }
            
            // Smooth scroll for internal links (jeśli jakieś będą na stronie bloga)
            document.addEventListener('click', function(e) {
                const link = e.target.closest('a');
                if (link && link.getAttribute('href') && link.getAttribute('href').startsWith('#')) {
                     e.preventDefault();
                    const targetId = link.getAttribute('href');
                    const targetElement = document.querySelector(targetId);
                    if (targetElement) {
                        const headerHeight = document.querySelector('header').offsetHeight;
                        const elementPosition = targetElement.getBoundingClientRect().top;
                        const offsetPosition = elementPosition + window.pageYOffset - headerHeight;
                        window.scrollTo({ top: offsetPosition, behavior: "smooth" });
                    }
                    if (navLinksContainer && navLinksContainer.classList.contains('active-mobile')) {
                        navLinksContainer.classList.remove('active-mobile');
                    }
                }
            });

            applyFadeInAnimation(); // Zastosuj animacje po załadowaniu DOM
        });

        window.addEventListener('scroll', function() { // Efekt zmiany tła nagłówka
            const header = document.querySelector('header');
            if (header) { 
                if (window.scrollY > 100) {
                    header.style.background = 'rgba(30, 58, 95, 0.95)'; 
                    header.style.backdropFilter = 'blur(10px)';
                } else {
                    header.style.background = 'linear-gradient(135deg, var(--navy-blue) 0%, var(--dark-navy) 100%)';
                    header.style.backdropFilter = 'none';
                }
            }
        });

    </script>
    <!-- Skrypt Voiceflow (jeśli chcesz go też na stronie bloga) -->
    <script type="text/javascript">
      (function(d, t) {
          var v = d.createElement(t), s = d.getElementsByTagName(t)[0];
          v.onload = function() {
            window.voiceflow.chat.load({
              verify: { projectID: '660c04457b8b244d89b5a822' },
              url: 'https://general-runtime.voiceflow.com',
              versionID: 'production',
            });
          }
          v.src = "https://cdn.voiceflow.com/widget-next/bundle.mjs"; v.type = "text/javascript"; s.parentNode.insertBefore(v, s);
      })(document, 'script');
    </script>
</body>
</html>
